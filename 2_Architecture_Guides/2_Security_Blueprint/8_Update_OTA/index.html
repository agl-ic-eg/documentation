<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Shankho Boron Ghosh">
    <link rel="canonical" href="http://docs.automotivelinux.org/2_Architecture_Guides/2_Security_Blueprint/8_Update_OTA/">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Update (Over The Air) - AGL Documentation</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Attack Vectors", url: "#_top", children: [
              {title: "Man In The Middle (MITM)", url: "#man-in-the-middle-mitm" },
              {title: "Man At The End (MATE)", url: "#man-at-the-end-mate" },
          ]},
          {title: "Acronyms and Abbreviations", url: "#acronyms-and-abbreviations", children: [
          ]},
          {title: "Firmware Over The Air", url: "#firmware-over-the-air", children: [
              {title: "Building", url: "#building" },
              {title: "Atomic Upgrades with Rollbacks", url: "#atomic-upgrades-with-rollbacks" },
          ]},
          {title: "Software Over The Air", url: "#software-over-the-air", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../9_Secure_development/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../9_Secure_development/" class="btn btn-xs btn-link">
        Secure development
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../7_Connectivity/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../7_Connectivity/" class="btn btn-xs btn-link">
        Connectivity
      </a>
    </div>
    
  </div>

    

    <p>Updating applications and firmware is essential for the development of new
features and even more to fix security bugs. However, if a malicious third party
manages to alter the content during transport, it could alter the functioning of
the system and/or applications. The security of the updates is therefore a
critical point to evaluate in order to guarantee the integrity, the
confidentiality and the legitimacy of the transmitted data.</p>
<h2 id="attack-vectors">Attack Vectors</h2>
<p>Updates Over The Air are one of the most common points where an attacker will
penetrate. An OTA update mechanism is one of the highest threats in the system.
If an attacker is able to install his own application or firmware on the system,
he can get the same level of access that the original application or firmware
had. From that point, the intruder can get unfettered access to the rest of the
system, which might include making modifications, downloading other pieces of
software, and stealing assets.</p>
<h3 id="man-in-the-middle-mitm">Man In The Middle (MITM)</h3>
<p>The man-in-the-middle attack is the most classic example of an attack, where an
adversary inserts himself between two communicating entities and grabs whatever
is being communicated. In the case of OTA attacks, the connection in the network
may be intercepted:</p>
<ul>
<li>On the internet, before the cloud back-end.</li>
<li>At the base station, 3G,4G,5G connection to the internet.</li>
<li>At the receiving antenna, connection to the car.</li>
<li>Between the receiving antenna and the gateway router (if present), connection
  within the car.</li>
<li>Between the gateway router and the target component (IVI, In-Vehicle
  Infotainment unit).</li>
</ul>
<p>There are many ways to mount a MITM attack. For example, proxy tools like Burp
Proxy can be used to intercept web traffic as a man-in-the-middle. Under the
guise of being a testing tool, the proxy server is often used in attack
scenarios. It runs on a variety of platforms.</p>
<p>As another example, false base station attacks are known to be fairly easy to
set-up. The problem is apparently fairly prevalent in countries like China and
in the UK. These fake base stations are sometimes just eavesdropping on the
communication, but others have the potential to do serious harm.</p>
<p>Defenses against MITM attacks include encrypted and signed data pipes.
Furthermore, architects and developers are also recommended to encrypt and sign
the payloads that are being passed over these pipes, to defend against perusal
of the data.</p>
<h3 id="man-at-the-end-mate">Man At The End (MATE)</h3>
<p>The man-at-the-end attack is when an intruder analyzes the end-point of the
communication when software is accessing the data communication. This is a more
severe attack type where the attacker can:</p>
<ul>
<li>Steal keys.</li>
<li>For example, a simple debugging session in running software could reveal a
    key used in memory.</li>
<li>Tamper software.</li>
<li>For example, replacing just one function call in software with a NOP (i.e.
    no operation) can drastically change the behavior of the program.</li>
<li>Jam branches of control.</li>
<li>For example, making a program take one branch of control rather than the
    intended branch can mean the difference between an authorized and a
    non-authorized installation.</li>
<li>Modify important data.</li>
<li>For example, if the data changed is a key or data leading to a control path,
    then this attack can be severe.</li>
<li>In the case of OTA updates, MATE attacks are particularly problematic for
    the system. One of the consequences of MATE attacks can be installed
    software that allows installation of any other software. For example, an
    attacker might install remote access software to control any part of the
    system.</li>
</ul>
<hr />
<h2 id="acronyms-and-abbreviations">Acronyms and Abbreviations</h2>
<p>The following table lists the terms utilized within this part of the document.</p>
<table>
<thead>
<tr>
<th>Acronyms or Abbreviations</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>FOTA</em></td>
<td><strong>F</strong>irmware <strong>O</strong>ver <strong>T</strong>he <strong>A</strong>ir</td>
</tr>
<tr>
<td><em>MATE</em></td>
<td><strong>M</strong>an <strong>A</strong>t <strong>T</strong>he <strong>E</strong>nd</td>
</tr>
<tr>
<td><em>MITM</em></td>
<td><strong>M</strong>an <strong>I</strong>n <strong>T</strong>he <strong>M</strong>iddle</td>
</tr>
<tr>
<td><em>OTA</em></td>
<td><strong>O</strong>ver <strong>T</strong>he <strong>A</strong>ir</td>
</tr>
<tr>
<td><em>SOTA</em></td>
<td><strong>S</strong>oftware <strong>O</strong>ver <strong>T</strong>he <strong>A</strong>ir</td>
</tr>
<tr>
<td><em>TUF</em></td>
<td><strong>T</strong>he <strong>U</strong>pdate <strong>F</strong>ramework</td>
</tr>
</tbody>
</table>
<h1 id="firmware-over-the-air">Firmware Over The Air</h1>
<p>The firmware update is critical since its alteration back to compromise the
entire system. It is therefore necessary to take appropriate protective
measures.</p>
<p>AGL includes the <em>meta-updater</em> Yocto layer that enables OTA software updates
via <a href="https://uptane.github.io">Uptane</a>, an automotive-specific extension to <a href="https://theupdateframework.github.io/">The
Update Framework</a>. Uptane and TUF are
open standards that define a secure protocol for delivering and verifying
updates even when the servers and network--internet and car-internal--aren't
fully trusted.</p>
<p><em>meta-updater</em> includes the application
<a href="https://github.com/advancedtelematic/aktualizr"><code>aktualizr</code></a>, developed
Advanced Telematic Systems (now part of HERE Technologies) that enables OTA for
an ECU. <code>aktualizr</code> combined with Uptane is suitable for updating the firmware,
software, and other packages on even functionally critical ECUs. <code>aktualizr</code> can
be enabled with the free, open souce backend
<a href="https://github.com/advancedtelematic/ota-community-edition"><code>ota-community-edition</code></a>.</p>
<p>This FOTA update mechanism can be enabled through the <code>agl-sota</code> feature.</p>
<h2 id="building">Building</h2>
<p>To build an AGL image that uses <code>aktualizr</code>, the following can be used.</p>
<div class="highlight"><pre><span></span><code>source meta-agl/scripts/aglsetup.sh -m &lt;machine&gt; agl-sota &lt;other-features...&gt;
</code></pre></div>
<p>During the build, <em>meta-updater</em> will use credentials downloaded from
<code>ota-community-edition</code> to sign metadata verifying the build as authentic. These
signatures are part of the Uptane framework and are used to verify FOTA updates.</p>
<h2 id="atomic-upgrades-with-rollbacks">Atomic Upgrades with Rollbacks</h2>
<p><code>aktualizr</code>'s primary method of updating firmware is to use <code>libostree</code> with
binary diffs. The binary diffs use the least amout of bandwidth, and by it's
nature <code>libostree</code> stores current and previous firmware versions on disk or in
flash memory to allow for rollbacks.</p>
<p><code>libostree</code> is a content addressable object store much like <code>git</code>. Versions are
specified via SHA2-256. These hashes are signed in the Uptane metadata and are
robust against cryptographic compromise.</p>
<h1 id="software-over-the-air">Software Over The Air</h1>
<p>Software updates in connected vehicles are a very useful feature, which can
deliver significant benefits. If not implemented with security in mind, software
updates can incur serious vulnerabilities. Any software update system must
ensure that not only are the software updates to devices done in a secure way,
but also that the repositories and servers hosting these updates are adequately
protected. As the process of updating software migrates from a Dealership update
model towards an <strong>OTA</strong> update model, securing these processes becomes a high
priority.</p>
<p><strong>SOTA</strong> is made possible by <strong>AppFw</strong> (See Platform part). It will be possible
to manage in a simple way the packets (i.g. Android like).</p>
<table>
<thead>
<tr>
<th>Domain</th>
<th>Improvement</th>
</tr>
</thead>
<tbody>
<tr>
<td>Update-SOTA-1</td>
<td>Part to complete.</td>
</tr>
</tbody>
</table>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../9_Secure_development/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../9_Secure_development/" class="btn btn-xs btn-link">
        Secure development
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../7_Connectivity/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../7_Connectivity/" class="btn btn-xs btn-link">
        Connectivity
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>